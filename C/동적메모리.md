# 동적 메모리

## 1. 정적 메모리 vs 동적 메모리
|---|정적 메모리|동적 메모리|    
|---|---|---|    
|메모리에 할당|컴파일 시|실행 시|    
|해제|자동|수동(프로그래머가 명시적으로 해주어야 함)|    
|사용 범위|지역변수 - 블록 내부<br>전역변수 - 프로그램전체|원하는 만큼|    
|메모리 관리|컴파일러|프로그래머|    

## 2. 동적 메모리를 쓰는 이유
```c
// 배열의 합을 구하고 싶다.
int n;
scanf("%d", &n);
int arr[n]; //error! 배열의 크기는 변수로 지정할 수 없다.

>>>>>>>>>>>>>>>

int arr[100]; //미리 크기 100인 배열 선언
scanf("%d", &n);
//n에 3만 입력한다면 => 메모리 낭비
//n에 200을 입력한다면 => 에러
```
- 동적 메모리를 사용하면 메모리 낭비 없이 원하는 만큼 메모리를 할당할 수 있다.
- 메모리 할당과 해제를 마음대로 할 수 있다.

## 3. 동적 메모리 사용
- 표준 C 라이브러리 함수가 필요하다 => <stdlib.h> 헤더 필요

### 1) 할당
- malloc 함수
> void *malloc(size_t size)

- 리턴값이 void* 형이기 때문에 형변환 후 사용해야한다.
- 메모리 할당에 실패하면 NULL을 반환한다.
	- 메모리 할당이 되었는지 확인해야한다.
```c
int n;
int* arr = NULL;
scanf("%d", &n);
arr = (int*)malloc(sizeof(int) * n);
//int 배열 원소 하나의 크기는 sizeof(int)
//크기가 n인 배열의 크기 = sizeof(int) * n

if(arr == NULL){
	printf("메모리 할당 실패\n");
	return -1;
}
```

### 2) 해제
- 동적 메모리 사용 후 반드시 해제해주어야 한다.
- free 함수
> void free(void* memblock)

- 메모리를 해제해도 포인터변수에는 주소값이 남아있다.
	- NULL값을 대입해주는 것이 안전하다.
```c
free(arr);
arr = NULL;
```